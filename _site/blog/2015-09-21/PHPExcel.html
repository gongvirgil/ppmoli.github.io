<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>PHPExcel类库的各种使用方法总结 | site of gongvirgil</title>
    <meta name="author" content="gongvirgil" />
    <meta name="renderer" content="webkit">
    <meta name="description" content="gongvirgil's Blog" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <link rel="shortcut icon" href="/public/images/favicon.ico" type="image/x-icon" />
    <link rel="alternate" type="application/atom+xml" title="Recent Entries" href="/atom.xml" />
    <link rel="stylesheet" href="/public/font-awesome-4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/public/css/default.css">
    <link rel="stylesheet" href="/public/scroll/jquery.mCustomScrollbar.css">
    <script type="text/javascript" src="/public/js/jquery-1.7.1.min.js"></script>
    <script type="text/javascript" src="/public/scroll/jquery.mCustomScrollbar.concat.min.js"></script>
    <script type="text/javascript" src="/public/js/default.js"></script>
  </head>
  <body>
    <!--
    <header id="home">
      <div class="navbar navbar-fixed-top">
        <div class="container">
            <div class="logo">
              <a href="/"><img src="/public/images/a.png" alt="GongVirgil" /></a>
            </div>
            <div class="menu">
              <a id="side-bar-btn"><i class="fa fa-navicon"></i></a>
            </div>
        </div>
      </div>
      <div class="header-content-wrap">
        <div class="container">
          
        </div>
      </div>
    </header>

    <div class="notice"></div>
    <div class="shadow-screen"></div>
    <div class="side-bar">
      <a id="side-bar-close-btn"><i class="fa fa-times"></i></a>
              <div id="menu-pages">
          <li><a href="/">HOME</a></li>
          <li><a href="/archive.html">ALL POSTS</a></li>
          <li><a href="/contact.html">CONTACT ME</a></li>
        </div>
        <div id="category">
            <h4>CATEGORY</h4>
            <div class="list-content">
              
              <li><a href="/category.html?CATE=技术">技术<span class="cate-size">23</span></a></li>
              
              <li><a href="/category.html?CATE=生活">生活<span class="cate-size">1</span></a></li>
              
              <li><a href="/category.html?CATE=随笔">随笔<span class="cate-size">2</span></a></li>
              
            </div>
            <div class="clear"></div>
        </div>
        <div id="tag">
            <h4>TAGS</h4>
            <div  class="tag-cloud">
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=html" title="1" style="font-size: 9.5pt; color: #999;">html</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=笔记" title="11" style="font-size: 12pt; color: #666;">笔记</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=jquery" title="1" style="font-size: 9.5pt; color: #999;">jquery</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=js" title="1" style="font-size: 9.5pt; color: #999;">js</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=Linux" title="1" style="font-size: 9.5pt; color: #999;">Linux</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=php" title="1" style="font-size: 9.5pt; color: #999;">php</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=css" title="2" style="font-size: 9.5pt; color: #888;">css</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=软件" title="1" style="font-size: 9.5pt; color: #999;">软件</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=Github" title="1" style="font-size: 9.5pt; color: #999;">Github</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=Blog" title="2" style="font-size: 9.5pt; color: #888;">Blog</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=Jekyll" title="1" style="font-size: 9.5pt; color: #999;">Jekyll</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=markdown" title="1" style="font-size: 9.5pt; color: #999;">markdown</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=page" title="1" style="font-size: 9.5pt; color: #999;">page</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=CSS" title="2" style="font-size: 9.5pt; color: #888;">CSS</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=sublime" title="1" style="font-size: 9.5pt; color: #999;">sublime</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=work" title="1" style="font-size: 9.5pt; color: #999;">work</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=code" title="1" style="font-size: 9.5pt; color: #999;">code</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=soft" title="1" style="font-size: 9.5pt; color: #999;">soft</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=购物" title="1" style="font-size: 9.5pt; color: #999;">购物</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=品牌" title="1" style="font-size: 9.5pt; color: #999;">品牌</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=日用品" title="1" style="font-size: 9.5pt; color: #999;">日用品</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=ThinkPHP" title="1" style="font-size: 9.5pt; color: #999;">ThinkPHP</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=linux" title="5" style="font-size: 10.5pt; color: #888;">linux</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=bootstrap" title="1" style="font-size: 9.5pt; color: #999;">bootstrap</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=vi" title="1" style="font-size: 9.5pt; color: #999;">vi</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=git" title="1" style="font-size: 9.5pt; color: #999;">git</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=laravel" title="2" style="font-size: 9.5pt; color: #888;">laravel</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=随笔" title="2" style="font-size: 9.5pt; color: #888;">随笔</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=任务" title="1" style="font-size: 9.5pt; color: #999;">任务</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=PHPExcel" title="1" style="font-size: 9.5pt; color: #999;">PHPExcel</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=Excel" title="1" style="font-size: 9.5pt; color: #999;">Excel</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=PHP" title="3" style="font-size: 10pt; color: #888;">PHP</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=单例模式" title="1" style="font-size: 9.5pt; color: #999;">单例模式</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=firefox" title="1" style="font-size: 9.5pt; color: #999;">firefox</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=插件" title="1" style="font-size: 9.5pt; color: #999;">插件</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=域名" title="1" style="font-size: 9.5pt; color: #999;">域名</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=重定向" title="1" style="font-size: 9.5pt; color: #999;">重定向</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=函数" title="1" style="font-size: 9.5pt; color: #999;">函数</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=mobile" title="1" style="font-size: 9.5pt; color: #999;">mobile</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=jQuery" title="1" style="font-size: 9.5pt; color: #999;">jQuery</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=英语" title="1" style="font-size: 9.5pt; color: #999;">英语</a>
                
                  
                  
                  
                  
                    
                  
                  
                    
                  
                  <a href="/tag.html?TAG=生词本" title="1" style="font-size: 9.5pt; color: #999;">生词本</a>
                
            </div>
            <div class="clear"></div>
        </div>



    </div>
    -->
    <header class="header">
      <div class="avatar">
        <img width="80" height="80" src="/public/images/me.png" class="circle">
        <a title="Virgil's Blog" href="/"><h2>Virgil's Blog</h2></a>
      </div>   
      <div class="links">
        <a title="返回主页" href="/"><i class="fa fa-home"></i></a>
        <a title="返回主页" href="/"><i class="fa fa-home"></i></a>
        <a title="返回主页" href="/"><i class="fa fa-home"></i></a>
        <a title="返回主页" href="/"><i class="fa fa-home"></i></a>
        <a title="返回主页" href="/"><i class="fa fa-home"></i></a>
      </div> 
      <div class="calculates">  
        <div class="calculate-item">
          <a href="/archive.html"><span class="calculate-item-count">32</span><span class="calculate-item-name">归档</span></a>
        </div>
        <div class="calculate-item">
          <a href="/category.html"><span class="calculate-item-count">3</span><span class="calculate-item-name">分类</span></a>
        </div>
        <div class="calculate-item">
          <a href="/tag.html"><span class="calculate-item-count">42</span><span class="calculate-item-name">标签</span></a>
        </div>
      </div>
    </header>
    <!--Main-->
    <div class="main">
      <div class="main-content">
            <link rel="stylesheet" type="text/css" href="/public/css/post.css">
    <link rel="stylesheet" type="text/css" href="/public/css/prettify.css">
    <!-- <link rel="stylesheet" type="text/css" href="/public/css/poole.css"> -->
    <div class="post-main">
        <div id="content">
            <div class="post">
                <div class="post_title">
                    <h1><a href="/blog/2015-09-21/PHPExcel.html" title="PHPExcel类库的各种使用方法总结">PHPExcel类库的各种使用方法总结</a></h1>
                </div>
                <div class="post_relate">
                    <span class="post_date">2015-09-21</span>
                    <span class="post_tags">
                        
                            <a href="/tags/?tag=PHPExcel" title="PHPExcel">PHPExcel</a>
                        
                            <a href="/tags/?tag=Excel" title="Excel">Excel</a>
                        
                    </span>
                </div>
                <div class="post_content">
                    <p>导入PHPExcel类库</p>

<pre><code>include 'PHPExcel.php';
include 'PHPExcel/Writer/Excel2007.php';
//或者include 'PHPExcel/Writer/Excel5.php'; 用于输出.xls的
</code></pre>

<p>创建一个excel</p>

<pre><code>$objPHPExcel = new PHPExcel();
</code></pre>

<p>保存excel—2007格式</p>

<pre><code>$objWriter = new PHPExcel_Writer_Excel2007($objPHPExcel);
//或者$objWriter = new PHPExcel_Writer_Excel5($objPHPExcel); 非2007格式
$objWriter-&gt;save("xxx.xlsx");
</code></pre>

<p>直接输出到浏览器</p>

<pre><code>$objWriter = new PHPExcel_Writer_Excel5($objPHPExcel);
header("Pragma: public");
header("Expires: 0″);
header("Cache-Control:must-revalidate, post-check=0, pre-check=0″);
header("Content-Type:application/force-download");
header("Content-Type:application/vnd.ms-execl");
header("Content-Type:application/octet-stream");
header("Content-Type:application/download");;
header('Content-Disposition:attachment;filename="resume.xls"');
header("Content-Transfer-Encoding:binary");
$objWriter-&gt;save('php://output');
</code></pre>

<p>——————————————————————————————————————–</p>

<p>设置excel的属性：</p>

<pre><code>//创建人
$objPHPExcel-&gt;getProperties()-&gt;setCreator("Maarten Balliauw");
//最后修改人
$objPHPExcel-&gt;getProperties()-&gt;setLastModifiedBy("Maarten Balliauw");
//标题
$objPHPExcel-&gt;getProperties()-&gt;setTitle("Office 2007 XLSX Test Document");
//题目
$objPHPExcel-&gt;getProperties()-&gt;setSubject("Office 2007 XLSX Test Document");
//描述
$objPHPExcel-&gt;getProperties()-&gt;setDescription("Test document for Office 2007 XLSX, generated using PHP classes.");
//关键字
$objPHPExcel-&gt;getProperties()-&gt;setKeywords("office 2007 openxml php");
//种类
$objPHPExcel-&gt;getProperties()-&gt;setCategory("Test result file");
</code></pre>

<p>——————————————————————————————————————–</p>

<p>设置当前的sheet</p>

<pre><code>$objPHPExcel-&gt;setActiveSheetIndex(0);
</code></pre>

<p>设置sheet的name</p>

<pre><code>$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Simple');
</code></pre>

<p>设置单元格的值</p>

<pre><code>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A1', 'String');
$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A2', 12);
$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A3', true);
$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('C5', '=SUM(C2:C4)');
$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('B8', '=MIN(B2:C5)');
</code></pre>

<p>合并单元格</p>

<pre><code>$objPHPExcel-&gt;getActiveSheet()-&gt;mergeCells('A18:E22');
</code></pre>

<p>分离单元格</p>

<pre><code>$objPHPExcel-&gt;getActiveSheet()-&gt;unmergeCells('A28:B28');
</code></pre>

<p>保护cell</p>

<pre><code>$objPHPExcel-&gt;getActiveSheet()-&gt;getProtection()-&gt;setSheet(true); // Needs to be set to true in order to enable any worksheet protection!
$objPHPExcel-&gt;getActiveSheet()-&gt;protectCells('A3:E13', 'PHPExcel');
</code></pre>

<p>设置格式</p>

<pre><code>// Set cell number formats
echo date('H:i:s') . " Set cell number formats\n";
$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('E4')-&gt;getNumberFormat()-&gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_CURRENCY_EUR_SIMPLE);
$objPHPExcel-&gt;getActiveSheet()-&gt;duplicateStyle( $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('E4'), 'E5:E13' );
</code></pre>

<p>设置宽width</p>

<pre><code>// Set column widths
$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('B')-&gt;setAutoSize(true);
$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('D')-&gt;setWidth(12);
</code></pre>

<p>设置font</p>

<pre><code>$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B1')-&gt;getFont()-&gt;setName('Candara');
$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B1')-&gt;getFont()-&gt;setSize(20);
$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B1')-&gt;getFont()-&gt;setBold(true);
$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B1')-&gt;getFont()-&gt;setUnderline(PHPExcel_Style_Font::UNDERLINE_SINGLE);
$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B1')-&gt;getFont()-&gt;getColor()-&gt;setARGB(PHPExcel_Style_Color::COLOR_WHITE);
$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('E1')-&gt;getFont()-&gt;getColor()-&gt;setARGB(PHPExcel_Style_Color::COLOR_WHITE);
$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('D13')-&gt;getFont()-&gt;setBold(true);
$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('E13')-&gt;getFont()-&gt;setBold(true);
</code></pre>

<p>设置align</p>

<pre><code>$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('D11')-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('D12')-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('D13')-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);
$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A18')-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_JUSTIFY);
//垂直居中
$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A18')-&gt;getAlignment()-&gt;setVertical(PHPExcel_Style_Alignment::VERTICAL_CENTER);
</code></pre>

<p>设置column的border</p>

<pre><code>$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A4')-&gt;getBorders()-&gt;getTop()-&gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THIN);
$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B4')-&gt;getBorders()-&gt;getTop()-&gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THIN);
$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('C4')-&gt;getBorders()-&gt;getTop()-&gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THIN);
$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('D4')-&gt;getBorders()-&gt;getTop()-&gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THIN);
$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('E4')-&gt;getBorders()-&gt;getTop()-&gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THIN);
</code></pre>

<p>设置border的color</p>

<pre><code>$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('D13')-&gt;getBorders()-&gt;getLeft()-&gt;getColor()-&gt;setARGB('FF993300');
$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('D13')-&gt;getBorders()-&gt;getTop()-&gt;getColor()-&gt;setARGB('FF993300');
$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('D13')-&gt;getBorders()-&gt;getBottom()-&gt;getColor()-&gt;setARGB('FF993300');
$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('E13')-&gt;getBorders()-&gt;getTop()-&gt;getColor()-&gt;setARGB('FF993300');
$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('E13')-&gt;getBorders()-&gt;getBottom()-&gt;getColor()-&gt;setARGB('FF993300');
$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('E13')-&gt;getBorders()-&gt;getRight()-&gt;getColor()-&gt;setARGB('FF993300');
</code></pre>

<p>设置填充颜色</p>

<pre><code>$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A1')-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);
$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A1')-&gt;getFill()-&gt;getStartColor()-&gt;setARGB('FF808080');
$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B1')-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);
$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B1')-&gt;getFill()-&gt;getStartColor()-&gt;setARGB('FF808080');
</code></pre>

<p>加图片</p>

<pre><code>$objDrawing = new PHPExcel_Worksheet_Drawing();
$objDrawing-&gt;setName('Logo');
$objDrawing-&gt;setDescription('Logo');
$objDrawing-&gt;setPath('./images/officelogo.jpg');
$objDrawing-&gt;setHeight(36);
$objDrawing-&gt;setWorksheet($objPHPExcel-&gt;getActiveSheet());
$objDrawing = new PHPExcel_Worksheet_Drawing();
$objDrawing-&gt;setName('Paid');
$objDrawing-&gt;setDescription('Paid');
$objDrawing-&gt;setPath('./images/paid.png');
$objDrawing-&gt;setCoordinates('B15');
$objDrawing-&gt;setOffsetX(110);
$objDrawing-&gt;setRotation(25);
$objDrawing-&gt;getShadow()-&gt;setVisible(true);
$objDrawing-&gt;getShadow()-&gt;setDirection(45);
$objDrawing-&gt;setWorksheet($objPHPExcel-&gt;getActiveSheet());
//处理中文输出问题
需要将字符串转化为UTF-8编码，才能正常输出，否则中文字符将输出为空白，如下处理：
 $str  = iconv('gb2312', 'utf-8', $str);
或者你可以写一个函数专门处理中文字符串：
function convertUTF8($str)
{
   if(empty($str)) return '';
   return  iconv('gb2312', 'utf-8', $str);
}
//从数据库输出数据处理方式
从数据库读取数据如：
$db = new Mysql($dbconfig);
$sql = "SELECT * FROM  表名";
$row = $db-&gt;GetAll($sql);  // $row 为二维数组
$count = count($row);
for ($i = 2; $i &lt;= $count+1; $i++) {
 $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A' . $i, convertUTF8($row[$i-2][1]));
 $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('B' . $i, convertUTF8($row[$i-2][2]));
 $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('C' . $i, convertUTF8($row[$i-2][3]));
 $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('D' . $i, convertUTF8($row[$i-2][4]));
 $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('E' . $i, convertUTF8(date("Y-m-d", $row[$i-2][5])));
 $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('F' . $i, convertUTF8($row[$i-2][6]));
 $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('G' . $i, convertUTF8($row[$i-2][7]));
 $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('H' . $i, convertUTF8($row[$i-2][8]));
}
</code></pre>

<p>在默认sheet后，创建一个worksheet</p>

<pre><code>echo date('H:i:s') . " Create new Worksheet object\n";
$objPHPExcel-&gt;createSheet();
$objWriter = PHPExcel_IOFactory::createWriter($objExcel, 'Excel5');
$objWriter-save('php://output');
</code></pre>
            
                </div>
            </div>
            <div class="pre-next">
                <li class="pre">上一篇：<a href="/blog/2015-09-15/task-list.html">任务清单之实现功能</a></a></li>
                <li class="next">下一篇：<a href="/blog/2015-10-09/PHP-singleton-pattern.html">PHP设计模式之单例模式</a></li>
            </div>
            <!-- 多说评论框 start -->
            <div class="ds-thread" data-thread-key="/blog/2015-09-21/PHPExcel" data-title="PHPExcel类库的各种使用方法总结" data-url="/blog/2015-09-21/PHPExcel.html"></div>
            <!-- 多说评论框 end -->
        </div>
    </div>
    <div class="post-anchor">
        <div id="BlogAnchor">
            <h4>目录<a id="AnchorContentToggle" title="展开" style="cursor:pointer;">[<span>+</span>]</a></h4>
            <div class="AnchorContent" id="AnchorContent"></div>
        </div> 
    </div>
    <div style="clear:both;"></div>
    <script type="text/javascript" src="/public/js/post.js"></script>
    <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:"gongvirgil"};
        (function() {
            var ds = document.createElement('script');
            ds.type = 'text/javascript';ds.async = true;
            ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.unstable.js';
            ds.charset = 'UTF-8';
            (document.getElementsByTagName('head')[0] 
             || document.getElementsByTagName('body')[0]).appendChild(ds);
        })();
        </script>
    <!-- 多说公共JS代码 end -->

    
      </div>
      <!--Footer-->
      <div class="footer">
        <div class="footer-inner">
    <div class="footer_info">
        <div class="friendly-links">
            <span>友好链接</span>
        </div>
        <div class="site-info">
          <p>Copyright © 2012-2015 gongvirgil.github.io <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1256615808'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s4.cnzz.com/z_stat.php%3Fid%3D1256615808%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));</script></p>
        </div>
    </div>      
    <div class="tj"></div>
</div>
      </div>
      <!--Footer End-->
    </div>
    <!--Main End-->
    <div class="sitebar-toggle">
      <a id="sitebar-toggle-btn"><i class="fa fa-navicon"></i></a>
    </div>
    <div class="goTop" >
      <a title="回到顶部" id="goTop_btn"><i class="fa fa-chevron-up"></i></a>
    </div>

    <!-- 多说js加载开始，一个页面只需要加载一次 -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:"gongvirgil"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = 'http://static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
    </script>
  </body>
</html>
